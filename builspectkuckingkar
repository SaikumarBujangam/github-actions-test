resource "aws_lambda_function" "lambda_codesync_function" {
  function_name = "${var.platform}-${var.lambda_function_name}"
  description   = "Lambda function that will be used to sync gilab repo into codecommit."
  memory_size   = "512"
  timeout       = "300"
  ephemeral_storage {
    size = "2048"
  }
  role         = aws_iam_role.lambda_role.arn
  image_uri    = "${var.ecr_repository_uri}:lambda-image-latest"
  package_type = "Image"

  lifecycle {
    ignore_changes = [
      # Ignore changes to image_uri, Because codebuild will
      # update the image_uri on latest build.
      image_uri,
    ]
  }
}
