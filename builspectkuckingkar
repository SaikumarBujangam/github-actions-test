    resource "aws_opensearchserverless_security_policy" "oss_security_network_policy_vpc_access" {
  name        = var.oss_security_network_policy_vpc_access_name
  type        = "network"
  description = "VPC access"
  policy = jsonencode([
    {
      Description = "VPC access to collection and Dashboards endpoint for ${var.oss_collection_name} collection",
      Rules = [
        {
          ResourceType = "collection",
          Resource = [
            "collection/${var.oss_collection_name}"
          ]
        },
        {
          ResourceType = "dashboard"
          Resource = [
            "collection/${var.oss_collection_name}"
          ]
        }
      ],
      AllowFromPublic = false,
      SourceVPCEs = var.source_vpc_list
    }
  ])
}
