resource "aws_cloudwatch_event_target" "codebuild" {

  rule      = aws_cloudwatch_event_rule.trigger_build_on_tag_updates.name
  target_id = "TriggerCodeBuild"
  arn       = module.docker_build.codebuild_project_arn
  role_arn  = aws_iam_role.cloudwatch_event_role.arn

  input_transformer {
    input_paths = {
      git_tag = "$.detail.referenceName"
    }
    input_template = "{ \"environmentVariablesOverride\": [ { \"name\": \"TAG\", \"value\": <git_tag> }, { \"name\": \"SOURCETRIGGER\", \"value\": \"REPO_TAG\" } ]}"
  }
}
C:\Users\umababy.kannan\OneDrive - HCL Technologies Ltd\Documents\Star CAP\project-infra-provisioning-services\terraform-init>terraform plan
╷
│ Error: Incorrect attribute value type
│
│   on ..\infra-scripts\project-infra-services\project-base-infra\cloudwatch.tf line 38, in resource "aws_cloudwatch_event_target" "codebuild":
│   38:   arn       = module.docker_build.codebuild_project_arn
│     ├────────────────
│     │ module.docker_build.codebuild_project_arn is empty tuple
│
│ Inappropriate value for attribute "arn": string required.
╵

module "docker_build" {
  source = "../../terraform-modules/terraform-aws-codebuild"

  
  build_project_name              = "${var.project_key}-cc-repo-docker-build"
  build_spec_file                 = "${path.module}/build_spec/docker-build.yml"
  codebuild_role_arn              = aws_iam_role.codebuild_role.arn
  source_location                 = module.project_codecommit[0].codecommit_repo_clone_url_http

  build_specific_variables = {
    "ecr_repository_url"       = module.project_ecr[0].ecr_repo_url
    
  }
  tags = merge(
    {
      "organization" = "${var.org_key}"
    }, 
    {
      "platform" = "${var.org_key}"
    }, 
    {
       "project_key" = "${var.project_key}"
    },
  )
}
