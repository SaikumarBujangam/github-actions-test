name: Check Pull Request Branches

on:
  pull_request:
    branches: [ master ]
    types: [opened, reopened, edited]
    
  workflow_call:
    secrets:
      envPAT:
        required: true
jobs:
  adl-cicd-check-pull-request:
    runs-on: ubuntu-latest
    steps:
      - name: Check Branches
        run: |
          echo "Pull Request on $GITHUB_REPOSITORY $GITHUB_HEAD_REF into $GITHUB_BASE_REF"
          base_branch_category=${GITHUB_BASE_REF%%/*}
          head_branch_category=${GITHUB_HEAD_REF%%/*}
          if [[ ${base_branch_category} == "master" ]]
          then
            if [[ "${head_branch_category}" == "feature" ]]
            then
              echo "Merging a feature branch into master is allowed"
              exit 0
            else
              echo "Merging a non-feature branch into master is not allowed"
              exit 1
            fi
          fi

