stages:
  - init
  - sonar-check

get-aws-keys-base:
  # ... (same as before)

get-aws-keys:
  # ... (same as before)
  rules:
    - if: '$CI_COMMIT_REF_NAME == "main" && $CI_PIPELINE_SOURCE == "merge_request_event"'
      when: always
    - when: never

sonar-check:
  # ... (same as before)
  rules:
    - if: '$CI_COMMIT_REF_NAME == "main" && $CI_PIPELINE_SOURCE == "merge_request_event"'
      when: always
    - when: never
