import boto3
import os
from alight.foundation.util.logging.standardlogger import StandardLogger

class JarBuildUtil:
    logger = StandardLogger().getDefaultLogger()

    def __init__(self, region='us-east-1', deployment_bucket=None):
        self.region = region
        self._s3_client = boto3.client('s3', region_name=self.region)
        self._bucket_name = deployment_bucket

    def upload_files_to_s3(self, files, destination_path):
        try:
            for file_path in files:
                s3_path = "{}/{}".format(destination_path, os.path.basename(file_path)).replace(os.sep, '/')
                self._s3_client.upload_file(file_path, self._bucket_name, s3_path)
                JarBuildUtil.logger.info("Uploaded file: {} to bucket: {} at path: {}".format(file_path, self._bucket_name, s3_path))
            return True
        except FileNotFoundError as e:
            JarBuildUtil.logger.error("File not found: {}. Error: {}".format(file_path, e))
            return False
        except Exception as e:
            JarBuildUtil.logger.error("Failed to upload the files. Error: {}".format(e))
            return False
