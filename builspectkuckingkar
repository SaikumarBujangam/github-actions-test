import psycopg2
import time
import uuid
from alight.foundation.util.logging.standardlogger import StandardLogger

class PostgresDataAPI:
    logger = StandardLogger().getDefaultLogger()

    def __init__(self, db_name=None, db_user_name=None, db_host=None, db_port=5432, db_password=None):
        self._conn = None
        self._cursor = None
        self._db_name = db_name
        self._db_user_name = db_user_name
        self._db_host = db_host
        self._db_port = db_port
        self._db_password = db_password

    def connect(self):
        try:
            connection_params = {
                "dbname": self._db_name,
                "user": self._db_user_name,
                "password": self._db_password,
                "host": self._db_host,
                "port": self._db_port
            }
            self._conn = psycopg2.connect(**connection_params)
            self.logger.info("Connected to the host: {}, database: {}".format(self._db_host, self._db_name))
            self._cursor = self._conn.cursor()  # Initialize the cursor here
        except Exception as e:
            self.logger.error(f"Error connecting to the database: {e}")
            raise
