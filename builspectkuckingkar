import boto3
import os
from alight.foundation.util.logging.standardlogger import StandardLogger

class JarBuildUtil:
    logger = StandardLogger().getDefaultLogger()

    def __init__(self, region='us-east-1', deployment_bucket=None):
        self.region = region
        self._s3_client = boto3.client('s3', region_name=self.region)
        self._bucket_name = deployment_bucket

    def upload_files_to_s3(self, files, destination_path):
        try:
            for file_path in files:
                # Adjust the S3 path to use slashes appropriate for S3 keys
                s3_path = os.path.join(destination_path, os.path.basename(file_path)).replace(os.sep, '/')
                self._s3_client.upload_file(file_path, self._bucket_name, s3_path)
                JarBuildUtil.logger.info(f"Uploaded file: {file_path} to bucket: {self._bucket_name} at path: {s3_path}")
            return True
        except FileNotFoundError as e:
            JarBuildUtil.logger.error(f"File not found: {file_path}. Error: {e}")
            return False
        except Exception as e:
            JarBuildUtil.logger.error(f"Failed to upload the files. Error: {e}")
            return False
